<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ni≈üan Davetiyesi</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Monsieur+La+Doulaise&display=swap" rel="stylesheet">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=DM+Serif+Text:ital@0;1&display=swap" rel="stylesheet">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Rozha+One&display=swap" rel="stylesheet">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Lora:ital,wght@0,400;0,500;0,600;0,700;1,400;1,500;1,600;1,700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <!-- Splash Screen / Cover Screen -->
    <div id="splash-screen" class="splash-screen">
        <div class="splash-content">
            <img src="logo.png" alt="Logo" class="splash-logo">
            <h1 class="splash-title">Nursu & Hakan</h1>
            <img src="rings.png" alt="Y√ºz√ºkler" class="splash-rings">
        </div>
        <div class="splash-indicator">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M7 10L12 15L17 10" stroke="#44442b" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
        </div>
    </div>
    
    <!-- Hidden Audio Player -->
    <audio id="music-player" loop preload="auto">
        <source src="stephen-sanchez-until-I-found-you.mp3" type="audio/mpeg">
    </audio>
    
    <div class="tables-container">
        <div class="table-item">
            <img src="guest-table.png" alt="Misafir Masasƒ±" class="guest-table-image">
        </div>
        <div class="table-item">
            <img src="guest-table.png" alt="Misafir Masasƒ±" class="guest-table-image">
        </div>
        <div class="table-item">
            <img src="guest-table.png" alt="Misafir Masasƒ±" class="guest-table-image">
        </div>
        <div class="table-item">
            <img src="guest-table.png" alt="Misafir Masasƒ±" class="guest-table-image">
        </div>
        <div class="table-item">
            <img src="guest-table.png" alt="Misafir Masasƒ±" class="guest-table-image">
        </div>
        <div class="table-item">
            <img src="guest-table.png" alt="Misafir Masasƒ±" class="guest-table-image">
        </div>
        <div class="table-item">
            <img src="guest-table.png" alt="Misafir Masasƒ±" class="guest-table-image">
        </div>
        <div class="table-item">
            <img src="guest-table.png" alt="Misafir Masasƒ±" class="guest-table-image">
        </div>
        <div class="table-item">
            <img src="guest-table.png" alt="Misafir Masasƒ±" class="guest-table-image">
        </div>
        <div class="table-item">
            <img src="guest-table.png" alt="Misafir Masasƒ±" class="guest-table-image">
        </div>
        <div class="table-item">
            <img src="guest-table.png" alt="Misafir Masasƒ±" class="guest-table-image">
        </div>
        <div class="table-item">
            <img src="guest-table.png" alt="Misafir Masasƒ±" class="guest-table-image">
        </div>
        <div class="table-item">
            <img src="guest-table.png" alt="Misafir Masasƒ±" class="guest-table-image">
        </div>
        <div class="table-item">
            <img src="guest-table.png" alt="Misafir Masasƒ±" class="guest-table-image">
        </div>
        <div class="table-item">
            <img src="guest-table.png" alt="Misafir Masasƒ±" class="guest-table-image">
        </div>
        <div class="table-item">
            <img src="guest-table.png" alt="Misafir Masasƒ±" class="guest-table-image">
        </div>
        <div class="table-item">
            <img src="guest-table.png" alt="Misafir Masasƒ±" class="guest-table-image">
        </div>
        <div class="table-item">
            <img src="guest-table.png" alt="Misafir Masasƒ±" class="guest-table-image">
        </div>
        <div class="table-item">
            <img src="guest-table.png" alt="Misafir Masasƒ±" class="guest-table-image">
        </div>
        <div class="table-item">
            <img src="guest-table.png" alt="Misafir Masasƒ±" class="guest-table-image">
        </div>
        <div class="table-item">
            <img src="guest-table.png" alt="Misafir Masasƒ±" class="guest-table-image">
        </div>
        <div class="table-item">
            <img src="guest-table.png" alt="Misafir Masasƒ±" class="guest-table-image">
        </div>
        <div class="table-item">
            <img src="guest-table.png" alt="Misafir Masasƒ±" class="guest-table-image">
        </div>
        <div class="table-item">
            <img src="guest-table.png" alt="Misafir Masasƒ±" class="guest-table-image">
        </div>
        <div class="table-item">
            <img src="guest-table.png" alt="Misafir Masasƒ±" class="guest-table-image">
        </div>
        <div class="table-item">
            <img src="guest-table.png" alt="Misafir Masasƒ±" class="guest-table-image">
        </div>
        <div class="table-item">
            <img src="guest-table.png" alt="Misafir Masasƒ±" class="guest-table-image">
        </div>
        <div class="table-item">
            <img src="guest-table.png" alt="Misafir Masasƒ±" class="guest-table-image">
        </div>
        <div class="table-item">
            <img src="guest-table.png" alt="Misafir Masasƒ±" class="guest-table-image">
        </div>
        <div class="table-item">
            <img src="guest-table.png" alt="Misafir Masasƒ±" class="guest-table-image">
        </div>
        <div class="table-item">
            <img src="guest-table.png" alt="Misafir Masasƒ±" class="guest-table-image">
        </div>
        <div class="table-item">
            <img src="guest-table.png" alt="Misafir Masasƒ±" class="guest-table-image">
        </div>
        <div class="table-item">
            <img src="guest-table.png" alt="Misafir Masasƒ±" class="guest-table-image">
        </div>
        <div class="table-item">
            <img src="guest-table.png" alt="Misafir Masasƒ±" class="guest-table-image">
        </div>
        <div class="table-item">
            <img src="guest-table.png" alt="Misafir Masasƒ±" class="guest-table-image">
        </div>
        <div class="table-item">
            <img src="guest-table.png" alt="Misafir Masasƒ±" class="guest-table-image">
        </div>
        <div class="table-item">
            <img src="guest-table.png" alt="Misafir Masasƒ±" class="guest-table-image">
        </div>
        <div class="table-item">
            <img src="guest-table.png" alt="Misafir Masasƒ±" class="guest-table-image">
        </div>
        <div class="table-item">
            <img src="guest-table.png" alt="Misafir Masasƒ±" class="guest-table-image">
        </div>
        <div class="table-item">
            <img src="guest-table.png" alt="Misafir Masasƒ±" class="guest-table-image">
        </div>
        <div class="table-item">
            <img src="guest-table.png" alt="Misafir Masasƒ±" class="guest-table-image">
        </div>
        <div class="table-item">
            <img src="guest-table.png" alt="Misafir Masasƒ±" class="guest-table-image">
        </div>
        <div class="table-item">
            <img src="guest-table.png" alt="Misafir Masasƒ±" class="guest-table-image">
        </div>
        <div class="table-item">
            <img src="guest-table.png" alt="Misafir Masasƒ±" class="guest-table-image">
        </div>
        <div class="table-item">
            <img src="guest-table.png" alt="Misafir Masasƒ±" class="guest-table-image">
        </div>
        <div class="table-item">
            <img src="guest-table.png" alt="Misafir Masasƒ±" class="guest-table-image">
        </div>
        <div class="table-item">
            <img src="guest-table.png" alt="Misafir Masasƒ±" class="guest-table-image">
        </div>
        <div class="table-item">
            <img src="guest-table.png" alt="Misafir Masasƒ±" class="guest-table-image">
        </div>
        <div class="table-item">
            <img src="guest-table.png" alt="Misafir Masasƒ±" class="guest-table-image">
        </div>
    </div>
    <div class="logo-container">
        <img src="logo.png" alt="Logo" class="logo-image">
    </div>
    <div class="names-container">
        <h1 class="couple-names">Nursu & Hakan</h1>
        <p class="event-date">
            <span class="event-line event-location-line">
                <span class="date-dot">‚Ä¢</span>
                <a href="https://share.google/S95nR7FDPxmbDPB29" target="_blank" class="event-location-link">Tekirdaƒü Yelken Spor Kul√ºb√º</a>
                <span class="date-dot">‚Ä¢</span>
            </span>
            <span class="event-line event-date-time-line">
                <span class="date-dot">‚Ä¢</span> 15.02.2026 <span class="date-dot">‚Ä¢</span> 18.00 <span class="date-dot">‚Ä¢</span>
            </span>
        </p>
        <p class="invitation-message">Ni≈üan t√∂renimizde sizleri de aramƒ±zda g√∂rmekten mutluluk duyarƒ±z.</p>
        <div class="family-names-container">
            <p class="family-name">√ñrsel Ailesi</p>
            <span class="family-separator">&</span>
            <p class="family-name">Ayta√ß Ailesi</p>
        </div>
        <div class="countdown-container">
            <div class="countdown-item">
                <div class="countdown-number" id="countdown-days">0</div>
                <div class="countdown-label">G√ºn</div>
            </div>
            <div class="countdown-item">
                <div class="countdown-number" id="countdown-hours">0</div>
                <div class="countdown-label">Saat</div>
            </div>
            <div class="countdown-item">
                <div class="countdown-number" id="countdown-minutes">0</div>
                <div class="countdown-label">Dakika</div>
            </div>
            <div class="countdown-item">
                <div class="countdown-number" id="countdown-seconds">0</div>
                <div class="countdown-label">Saniye</div>
            </div>
        </div>
        <div class="action-buttons">
            <button class="rsvp-button" id="rsvp-button">Katƒ±lƒ±m Durumu</button>
            <a href="https://calendar.google.com/calendar/render?action=TEMPLATE&text=Ni≈üan+T√∂reni+-+Nursu+%26+Hakan&dates=20260215T150000Z/20260215T200000Z&details=Ni≈üan+t√∂renimizde+sizleri+de+aramƒ±zda+g√∂rmekten+mutluluk+duyarƒ±z.&location=Tekirdaƒü+Yelken+Spor+Kul√ºb√º" target="_blank" class="calendar-button" id="calendar-button">Takvime Ekle</a>
        </div>
    </div>
    
    <!-- RSVP Modal -->
    <div class="rsvp-modal" id="rsvp-modal">
        <div class="rsvp-modal-content">
            <span class="rsvp-close" id="rsvp-close">&times;</span>
            <h2 class="rsvp-title">Katƒ±lƒ±m Durumu</h2>
            <form class="rsvp-form" id="rsvp-form">
                <div class="rsvp-form-group">
                    <label for="rsvp-firstname">ƒ∞sim *</label>
                    <input type="text" id="rsvp-firstname" name="firstname" required>
                </div>
                <div class="rsvp-form-group">
                    <label for="rsvp-lastname">Soyisim *</label>
                    <input type="text" id="rsvp-lastname" name="lastname" required>
                </div>
                <div class="rsvp-form-group">
                    <label>Katƒ±lƒ±m Durumu *</label>
                    <div class="attendance-options">
                        <label class="attendance-option">
                            <input type="radio" name="attendance" value="yes" required>
                            <span>Geleceƒüim</span>
                        </label>
                        <label class="attendance-option">
                            <input type="radio" name="attendance" value="no" required>
                            <span>Gelemeyeceƒüim</span>
                        </label>
                    </div>
                </div>
                <div class="rsvp-form-group" id="guest-count-group">
                    <label for="rsvp-guest-count">Ki≈üi Sayƒ±sƒ± *</label>
                    <input type="number" id="rsvp-guest-count" name="guestCount" min="1" max="20" value="1">
                </div>
                <div class="rsvp-form-group">
                    <button type="submit" class="rsvp-submit">G√∂nder</button>
                </div>
            </form>
            <div class="rsvp-success" id="rsvp-success" style="display: none;">
                <p id="rsvp-success-message"></p>
            </div>
        </div>
    </div>
    <div class="bride-groom-container">
        <img src="bride-and-groom.png" alt="Gelin ve Damat" class="bride-groom-image">
    </div>
    <script>
        // CRITICAL: This must run immediately
        console.log('üöÄüöÄüöÄ SCRIPT TAG √áALI≈ûTI - GitHub Pages Test üöÄüöÄüöÄ');
        window.testScriptLoaded = true;
        console.log('Sayfa URL:', window.location.href);
        console.log('Document ready state:', document.readyState);
        console.log('Timestamp:', new Date().toISOString());
        
        // Test if script tag is executed - make it very visible
        if (typeof window !== 'undefined') {
            window.testScriptLoaded = true;
            console.log('‚úÖ Window object mevcut');
            // Make it visible in page title too
            if (document.title) {
                document.title = 'Nursu & Hakan - Ni≈üan T√∂reni';
            }
        }
        
        let audioPlayer;
        let musicUnmuted = false; // Global flag to track if music is unmuted
        let audioPlayerInitialized = false; // Prevent multiple initializations
        
        // Initialize Audio Player
        function initAudioPlayer() {
            // Prevent multiple initializations
            if (audioPlayerInitialized) {
                console.log('‚ö†Ô∏è Audio player zaten ba≈ülatƒ±lmƒ±≈ü');
                return;
            }
            
            audioPlayer = document.getElementById('music-player');
            if (!audioPlayer) {
                console.error('‚ùå Audio player bulunamadƒ±');
                return;
            }
            
            audioPlayerInitialized = true;
            console.log('‚úÖ Audio player bulundu');
            
            // Start muted for autoplay compatibility
            audioPlayer.volume = 0;
            audioPlayer.muted = true;
            console.log('Sessiz mod aktif');
            
            // Wait for audio to be ready
            audioPlayer.addEventListener('canplaythrough', () => {
                console.log('‚úÖ Audio hazƒ±r (canplaythrough)');
            }, { once: true });
            
            // Don't try to play here - wait for user interaction
            // Just prepare the player
            console.log('üéµ Audio player hazƒ±r, kullanƒ±cƒ± etkile≈üimi bekleniyor...');
            
            // Global function to unmute and play
            window.unmuteAndPlay = function() {
                console.log('üñ±Ô∏è unmuteAndPlay √ßaƒürƒ±ldƒ±');
                
                if (!audioPlayer) {
                    audioPlayer = document.getElementById('music-player');
                    if (!audioPlayer) {
                        console.error('‚ùå Audio player bulunamadƒ±');
                        return;
                    }
                }
                
                // Check if already unmuted
                if (musicUnmuted && !audioPlayer.muted && audioPlayer.volume > 0) {
                    console.log('‚úÖ M√ºzik zaten a√ßƒ±k, tekrar a√ßƒ±lmaya gerek yok');
                    return;
                }
                
                console.log('Ses a√ßƒ±lƒ±yor...');
                
                // Reset to beginning
                audioPlayer.currentTime = 0;
                
                // Unmute and set volume
                audioPlayer.muted = false;
                audioPlayer.volume = 1.0;
                
                // Play the audio
                const playPromise = audioPlayer.play();
                if (playPromise !== undefined) {
                    playPromise.then(() => {
                        musicUnmuted = true;
                        console.log('‚úÖ M√ºzik √ßalƒ±yor (ses a√ßƒ±k)');
                    }).catch((e) => {
                        console.error('M√ºzik oynatƒ±lamadƒ±:', e);
                        musicUnmuted = false;
                    });
                }
            };
        }
        
        // Initialize audio player when page loads
        window.addEventListener('load', () => {
            console.log('üìÑ Sayfa y√ºklendi, audio player ba≈ülatƒ±lƒ±yor');
            initAudioPlayer();
        });
        
        // Also try immediately if DOM is ready
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', () => {
                console.log('üìÑ DOMContentLoaded event tetiklendi');
                initAudioPlayer();
            });
        } else {
            console.log('Document zaten hazƒ±r, hemen ba≈ülatƒ±lƒ±yor');
            initAudioPlayer();
        }
        
        function hideCutTables() {
            const container = document.querySelector('.tables-container');
            const tables = document.querySelectorAll('.table-item');
            const containerRect = container.getBoundingClientRect();
            
            tables.forEach(table => {
                const tableRect = table.getBoundingClientRect();
                const isVisible = tableRect.top >= containerRect.top && 
                                 tableRect.bottom <= containerRect.bottom;
                
                if (!isVisible) {
                    table.style.display = 'none';
                } else {
                    table.style.display = 'flex';
                }
            });
        }
        
        let tablesPositioned = false; // Flag to track if tables are positioned
        
        function showTablesRandomly() {
            const tables = Array.from(document.querySelectorAll('.table-item'));
            // Filter only visible tables (not cut off)
            const container = document.querySelector('.tables-container');
            const containerRect = container.getBoundingClientRect();
            
            const visibleTables = tables.filter(table => {
                const tableRect = table.getBoundingClientRect();
                return tableRect.top >= containerRect.top && 
                       tableRect.bottom <= containerRect.bottom;
            });
            
            // Shuffle array randomly
            for (let i = visibleTables.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [visibleTables[i], visibleTables[j]] = [visibleTables[j], visibleTables[i]];
            }
            
            // Show tables one by one with delay
            visibleTables.forEach((table, index) => {
                setTimeout(() => {
                    table.style.opacity = '1';
                }, index * 50); // 50ms delay between each table
            });
            
            // For mobile: mark tables as positioned after they're all visible
            const isMobile = window.innerWidth <= 480;
            if (isMobile && !tablesPositioned) {
                // Wait for all tables to be visible, then mark as positioned
                const totalDelay = visibleTables.length * 50 + 200; // Wait for all animations + buffer
                setTimeout(() => {
                    tablesPositioned = true;
                }, totalDelay);
            }
        }
        
        /**
         * Check if table significantly overlaps with bride and groom image
         * Only removes table if it's actually overlapping the image boundaries
         * @param {DOMRect} brideGroomRect - Bride and groom image rectangle
         * @param {DOMRect} tableRect - Table rectangle
         * @returns {boolean} - True if table should be removed
         */
        function shouldRemoveTable(brideGroomRect, tableRect) {
            // First check: If table is completely above or below the image, don't remove
            if (tableRect.bottom < brideGroomRect.top || tableRect.top > brideGroomRect.bottom) {
                return false;
            }
            
            // Second check: If table is completely to the left or right of the image, don't remove
            if (tableRect.right < brideGroomRect.left || tableRect.left > brideGroomRect.right) {
                return false;
            }
            
            // Calculate table center point FIRST
            const tableCenterX = tableRect.left + (tableRect.width / 2);
            const tableCenterY = tableRect.top + (tableRect.height / 2);
            
            // PRIMARY CHECK: If table center is inside bride and groom image, remove it
            const isCenterInside = tableCenterX >= brideGroomRect.left &&
                                  tableCenterX <= brideGroomRect.right &&
                                  tableCenterY >= brideGroomRect.top &&
                                  tableCenterY <= brideGroomRect.bottom;
            
            if (isCenterInside) {
                return true; // Center is inside, definitely remove
            }
            
            // SECONDARY CHECK: Only if center is not inside, check overlap percentage
            // Calculate overlap area
            const overlapLeft = Math.max(brideGroomRect.left, tableRect.left);
            const overlapRight = Math.min(brideGroomRect.right, tableRect.right);
            const overlapTop = Math.max(brideGroomRect.top, tableRect.top);
            const overlapBottom = Math.min(brideGroomRect.bottom, tableRect.bottom);
            
            // If no actual overlap, don't remove
            if (overlapRight <= overlapLeft || overlapBottom <= overlapTop) {
                return false;
            }
            
            const overlapWidth = overlapRight - overlapLeft;
            const overlapHeight = overlapBottom - overlapTop;
            const overlapArea = overlapWidth * overlapHeight;
            
            // Calculate table area
            const tableArea = tableRect.width * tableRect.height;
            
            // Calculate overlap percentage
            const overlapPercentage = (overlapArea / tableArea) * 100;
            
            // Remove table ONLY if more than 50% of table area overlaps (very strict)
            // This ensures we only remove tables that are truly overlapping, not just touching
            return overlapPercentage > 50;
        }
        
        /**
         * Remove guest tables that overlap with bride and groom image
         * This function is responsive and works for all screen sizes
         * Only removes tables with significant overlap (center inside or >30% area)
         */
        function removeOverlappingTables() {
            const brideGroomContainer = document.querySelector('.bride-groom-container');
            const brideGroomImage = document.querySelector('.bride-groom-image');
            
            if (!brideGroomContainer || !brideGroomImage) {
                console.log('‚ö†Ô∏è Gelin ve damat g√∂rseli bulunamadƒ±');
                return;
            }
            
            // Get the actual bounding rectangle of the bride and groom image
            // Use the image element itself, not the container, for accurate coordinates
            const originalRect = brideGroomImage.getBoundingClientRect();
            
            // Determine screen size for responsive shrink percentage
            const screenWidth = window.innerWidth;
            const isMobile = screenWidth <= 480;
            const isTablet = screenWidth > 480 && screenWidth <= 768;
            
            // Adjust shrink percentage based on screen size
            // Mobile and tablet need more aggressive shrinking due to smaller screens
            let shrinkPercentage;
            if (isMobile) {
                shrinkPercentage = 0.20; // 20% from each side for mobile (more precise)
            } else if (isTablet) {
                shrinkPercentage = 0.18; // 18% from each side for tablet
            } else {
                shrinkPercentage = 0.15; // 15% from each side for desktop
            }
            
            const widthShrink = originalRect.width * shrinkPercentage;
            const heightShrink = originalRect.height * shrinkPercentage;
            
            // Create a smaller detection rectangle (centered)
            const brideGroomRect = {
                left: originalRect.left + widthShrink,
                top: originalRect.top + heightShrink,
                right: originalRect.right - widthShrink,
                bottom: originalRect.bottom - heightShrink,
                width: originalRect.width - (widthShrink * 2),
                height: originalRect.height - (heightShrink * 2)
            };
            
            console.log('üîç Gelin ve damat koordinatlarƒ± (k√º√ß√ºlt√ºlm√º≈ü alan):', {
                screenSize: isMobile ? 'Mobile' : (isTablet ? 'Tablet' : 'Desktop'),
                shrinkPercentage: (shrinkPercentage * 100).toFixed(0) + '%',
                original: {
                    left: originalRect.left.toFixed(2),
                    top: originalRect.top.toFixed(2),
                    right: originalRect.right.toFixed(2),
                    bottom: originalRect.bottom.toFixed(2),
                    width: originalRect.width.toFixed(2),
                    height: originalRect.height.toFixed(2)
                },
                detection: {
                    left: brideGroomRect.left.toFixed(2),
                    top: brideGroomRect.top.toFixed(2),
                    right: brideGroomRect.right.toFixed(2),
                    bottom: brideGroomRect.bottom.toFixed(2),
                    width: brideGroomRect.width.toFixed(2),
                    height: brideGroomRect.height.toFixed(2)
                }
            });
            
            // Get all visible guest tables
            const allTables = document.querySelectorAll('.table-item');
            const container = document.querySelector('.tables-container');
            const containerRect = container ? container.getBoundingClientRect() : null;
            
            let removedCount = 0;
            let checkedCount = 0;
            
            allTables.forEach((table, index) => {
                // Only check tables that are currently visible
                if (table.style.display === 'none' || table.style.opacity === '0') {
                    return; // Skip already hidden tables
                }
                
                // Get table's bounding rectangle
                const tableRect = table.getBoundingClientRect();
                
                // Check if table is within container bounds (if container exists)
                if (containerRect) {
                    const isTableVisible = tableRect.top >= containerRect.top && 
                                         tableRect.bottom <= containerRect.bottom &&
                                         tableRect.left >= containerRect.left &&
                                         tableRect.right <= containerRect.right;
                    
                    if (!isTableVisible) {
                        return; // Skip tables outside container
                    }
                }
                
                checkedCount++;
                
                // Check if table should be removed (significant overlap)
                if (shouldRemoveTable(brideGroomRect, tableRect)) {
                    // Calculate overlap details for logging
                    const overlapLeft = Math.max(brideGroomRect.left, tableRect.left);
                    const overlapRight = Math.min(brideGroomRect.right, tableRect.right);
                    const overlapTop = Math.max(brideGroomRect.top, tableRect.top);
                    const overlapBottom = Math.min(brideGroomRect.bottom, tableRect.bottom);
                    const overlapWidth = overlapRight - overlapLeft;
                    const overlapHeight = overlapBottom - overlapTop;
                    const overlapArea = overlapWidth * overlapHeight;
                    const tableArea = tableRect.width * tableRect.height;
                    const overlapPercentage = (overlapArea / tableArea) * 100;
                    
                    // Check if center is inside
                    const tableCenterX = tableRect.left + (tableRect.width / 2);
                    const tableCenterY = tableRect.top + (tableRect.height / 2);
                    const isCenterInside = tableCenterX >= brideGroomRect.left &&
                                          tableCenterX <= brideGroomRect.right &&
                                          tableCenterY >= brideGroomRect.top &&
                                          tableCenterY <= brideGroomRect.bottom;
                    
                    console.log(`üóëÔ∏è √áakƒ±≈üan masa kaldƒ±rƒ±lƒ±yor (${index}):`, {
                        tableCenter: { x: tableCenterX.toFixed(2), y: tableCenterY.toFixed(2) },
                        centerInside: isCenterInside,
                        overlapPercentage: overlapPercentage.toFixed(2) + '%',
                        tableSize: { width: tableRect.width.toFixed(2), height: tableRect.height.toFixed(2) }
                    });
                    
                    // Remove the overlapping table
                    // For mobile, use visibility: hidden to keep grid position
                    const isMobile = window.innerWidth <= 480;
                    if (isMobile && tablesPositioned) {
                        // Keep grid position, just hide visually
                        table.style.opacity = '0';
                        table.style.visibility = 'hidden';
                        table.style.pointerEvents = 'none';
                    } else {
                        table.style.opacity = '0';
                        table.style.display = 'none';
                    }
                    removedCount++;
                }
            });
            
            console.log(`‚úÖ ${checkedCount} masa kontrol edildi, ${removedCount} √ßakƒ±≈üan masa kaldƒ±rƒ±ldƒ±`);
        }
        
        let brideGroomShown = false; // Flag to prevent multiple calls
        
        function showBrideGroom() {
            // Prevent multiple calls
            if (brideGroomShown) {
                console.log('‚ö†Ô∏è Gelin ve damat zaten g√∂sterildi, tekrar g√∂sterilmiyor');
                return;
            }
            
            const brideGroom = document.querySelector('.bride-groom-container');
            if (brideGroom) {
                brideGroomShown = true;
                brideGroom.style.opacity = '1';
                
                // Wait a bit for the image to render and get accurate coordinates
                // Then remove overlapping tables
                // Mobile and tablet need more time for layout to stabilize
                const screenWidth = window.innerWidth;
                const isMobile = screenWidth <= 480;
                const isTablet = screenWidth > 480 && screenWidth <= 768;
                const delay = isMobile ? 200 : (isTablet ? 150 : 100);
                
                setTimeout(() => {
                    removeOverlappingTables();
                }, delay);
                
                // Start flower rain after bride-groom appears
                setTimeout(startFlowerRain, 500);
            }
        }
        
        let firstFlowerLanded = false;
        let flowerRainStarted = false; // Flag to prevent multiple flower rain instances
        
        function startFlowerRain() {
            // Prevent multiple flower rain instances
            if (flowerRainStarted) {
                console.log('‚ö†Ô∏è √ái√ßek yaƒümuru zaten ba≈üladƒ±, tekrar ba≈ülatƒ±lmƒ±yor');
                return;
            }
            
            // Check if there's already a flower container
            const existingContainer = document.querySelector('.flower-container');
            if (existingContainer) {
                console.log('‚ö†Ô∏è √ái√ßek container zaten var, yeni olu≈üturulmuyor');
                return;
            }
            
            flowerRainStarted = true;
            console.log('üå∏ √ái√ßek yaƒümuru ba≈ülatƒ±lƒ±yor...');
            
            const flowerContainer = document.createElement('div');
            flowerContainer.className = 'flower-container';
            document.body.appendChild(flowerContainer);
            
            const flowerCount = 150; // Tonlarca √ßi√ßek
            const screenWidth = window.innerWidth;
            
            for (let i = 0; i < flowerCount; i++) {
                setTimeout(() => {
                    createFlower(flowerContainer, screenWidth, i === 0);
                }, i * 20); // Her 20ms'de bir √ßi√ßek olu≈ütur (daha hƒ±zlƒ±)
            }
            
            // Hide all flowers after they all land on the ground
            // Last flower creation time: (flowerCount - 1) * 20ms
            // Max animation duration: 3s (1.5 + 1.5)
            // Max delay: 0.5s
            // Total: ~6.5 seconds
            const lastFlowerCreationTime = (flowerCount - 1) * 20;
            const maxAnimationTime = 3500; // 3s animation + 0.5s delay (with some buffer)
            const totalTime = lastFlowerCreationTime + maxAnimationTime;
            
            setTimeout(() => {
                const flowers = flowerContainer.querySelectorAll('.falling-flower');
                flowers.forEach(flower => {
                    flower.style.opacity = '0';
                    flower.style.transition = 'opacity 1s ease-out';
                });
                
                // Remove container after fade out
                setTimeout(() => {
                    if (flowerContainer.parentNode) {
                        flowerContainer.parentNode.removeChild(flowerContainer);
                    }
                    // Reset flag after container is removed (for potential future use)
                    // flowerRainStarted = false; // Uncomment if you want to allow restart
                }, 1000);
            }, totalTime);
        }
        
        function createFlower(container, screenWidth, isFirst) {
            const flower = document.createElement('img');
            flower.src = 'flower.png';
            flower.className = 'falling-flower';
            flower.alt = '√ái√ßek';
            
            // Random horizontal position
            const randomX = Math.random() * screenWidth;
            flower.style.left = randomX + 'px';
            
            // Random size
            const randomSize = 30 + Math.random() * 40; // 30-70px arasƒ±
            flower.style.width = randomSize + 'px';
            flower.style.height = 'auto';
            
            // Random rotation for landing (unique for each flower)
            const randomRotation = Math.random() * 360; // 0-360 degrees
            
            // Random animation duration (daha hƒ±zlƒ±)
            const randomDuration = 1.5 + Math.random() * 1.5; // 1.5-3 saniye arasƒ±
            flower.style.animationDuration = randomDuration + 's';
            
            // Random delay
            const randomDelay = Math.random() * 0.5;
            flower.style.animationDelay = randomDelay + 's';
            
            container.appendChild(flower);
            
            // Calculate landing position after image loads
            const viewportHeight = window.innerHeight;
            let actualFlowerHeight = randomSize; // Default estimate
            
            // Wait for image to load to get actual height
            flower.onload = function() {
                actualFlowerHeight = flower.offsetHeight || flower.naturalHeight || randomSize;
                const landingPosition = viewportHeight - actualFlowerHeight;
                flower.style.setProperty('--landing-position', landingPosition + 'px');
            };
            
            // If image already loaded
            if (flower.complete) {
                actualFlowerHeight = flower.offsetHeight || flower.naturalHeight || randomSize;
                const landingPosition = viewportHeight - actualFlowerHeight;
                flower.style.setProperty('--landing-position', landingPosition + 'px');
            }
            
            // After animation completes, ensure flower stays at bottom with random rotation
            const totalAnimationTime = (randomDuration + randomDelay) * 1000;
            setTimeout(() => {
                // Get actual flower height
                const finalHeight = flower.offsetHeight || flower.naturalHeight || actualFlowerHeight;
                const finalLandingPosition = viewportHeight - finalHeight;
                
                // Stop animation and position at bottom with unique random rotation
                flower.style.animation = 'none';
                flower.style.transform = `translateY(${finalLandingPosition}px) rotate(${randomRotation}deg)`;
                flower.style.top = '0';
            }, totalAnimationTime);
            
            // Hide bride and groom image before frame appears
            if (isFirst && !firstFlowerLanded) {
                firstFlowerLanded = true;
                const totalTime = (randomDuration + randomDelay) * 1000;
                
                // Hide bride and groom image 800ms before frame/text appears
                setTimeout(() => {
                    const brideGroom = document.querySelector('.bride-groom-container');
                    if (brideGroom) {
                        brideGroom.style.opacity = '0';
                    }
                }, totalTime - 800);
                
                setTimeout(() => {
                    showCoupleNames();
                }, totalTime);
            }
        }
        
        function showCoupleNames() {
            const namesContainer = document.querySelector('.names-container');
            const coupleNames = document.querySelector('.couple-names');
            const logoContainer = document.querySelector('.logo-container');
            const message = document.querySelector('.invitation-message');
            
            // Hide all guest table images completely
            const allTables = document.querySelectorAll('.table-item');
            // Check both width and orientation for better mobile detection
            const isMobile = window.innerWidth <= 480 || (window.innerWidth <= 768 && window.matchMedia('(orientation: portrait)').matches);
            
            allTables.forEach(table => {
                table.style.opacity = '0';
                // For mobile, use visibility: hidden to keep grid position
                if (isMobile && tablesPositioned) {
                    table.style.visibility = 'hidden';
                    table.style.pointerEvents = 'none';
                } else {
                    table.style.display = 'none';
                }
            });
            
            // Show frame background when tables disappear
            document.body.classList.add('show-frame');
            
            // Force reload frame images with cache-busting timestamp
            const timestamp = new Date().getTime();
            
            console.log('Frame g√∂steriliyor - Geni≈ülik:', window.innerWidth, 'Mobil:', isMobile);
            
            if (isMobile) {
                // Mobile: use portrait frame
                document.body.style.backgroundImage = `url('frame-portrait.png?v=${timestamp}')`;
                document.body.style.backgroundSize = 'contain';
                document.body.style.backgroundPosition = '50% 60%';
                document.body.style.backgroundRepeat = 'no-repeat';
                document.body.style.padding = '0';
                document.body.style.margin = '0';
                document.body.style.height = '100vh';
                document.body.style.minHeight = '100vh';
                document.body.style.display = 'flex';
                document.body.style.alignItems = 'center';
                document.body.style.justifyContent = 'center';
                console.log('‚úÖ Portrait frame y√ºklendi');
            } else {
                // Desktop/Tablet: use landscape frame
                document.body.style.backgroundImage = `url('frame-landscape.png?v=${timestamp}')`;
                if (window.innerWidth >= 769) {
                    document.body.style.backgroundSize = '70% auto';
                } else {
                    document.body.style.backgroundSize = 'contain';
                }
                console.log('‚úÖ Landscape frame y√ºklendi');
            }
            
            if (namesContainer && coupleNames) {
                // First show couple names
                namesContainer.style.opacity = '1';
                coupleNames.style.opacity = '1';
                
                // Show date together with couple names
                const eventDate = document.querySelector('.event-date');
                if (eventDate) eventDate.style.opacity = '1';
                
                // Then show logo and message after a delay
                setTimeout(() => {
                    if (logoContainer) logoContainer.style.opacity = '1';
                    if (message) message.style.opacity = '1';
                    
                    // Show additional info after message
                    const familyNamesContainer = document.querySelector('.family-names-container');
                    
                    setTimeout(() => {
                        if (familyNamesContainer) familyNamesContainer.style.opacity = '1';
                        
                        // Show countdown after family names
                        const countdownContainer = document.querySelector('.countdown-container');
                        if (countdownContainer) {
                            countdownContainer.style.opacity = '1';
                            initCountdown();
                        }
                        
                        // Show action buttons
                        const actionButtons = document.querySelector('.action-buttons');
                        if (actionButtons) {
                            actionButtons.style.opacity = '1';
                        }
                    }, 300);
                }, 500); // 500ms delay after couple names appear
            }
        }
        
        // Countdown Timer
        function initCountdown() {
            // Target date: 15 ≈ûUBAT 2026 (Turkey timezone)
            const targetDate = new Date('2026-02-15T00:00:00+03:00').getTime();
            
            const daysElement = document.getElementById('countdown-days');
            const hoursElement = document.getElementById('countdown-hours');
            const minutesElement = document.getElementById('countdown-minutes');
            const secondsElement = document.getElementById('countdown-seconds');
            
            if (!daysElement || !hoursElement || !minutesElement || !secondsElement) {
                console.log('‚ö†Ô∏è Geri sayƒ±m elementleri bulunamadƒ±');
                return;
            }
            
            function updateCountdown() {
                const now = new Date().getTime();
                const distance = targetDate - now;
                
                if (distance < 0) {
                    // Event has passed
                    daysElement.textContent = '0';
                    hoursElement.textContent = '0';
                    minutesElement.textContent = '0';
                    secondsElement.textContent = '0';
                    return;
                }
                
                const days = Math.floor(distance / (1000 * 60 * 60 * 24));
                const hours = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
                const minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
                const seconds = Math.floor((distance % (1000 * 60)) / 1000);
                
                daysElement.textContent = days;
                hoursElement.textContent = hours.toString().padStart(2, '0');
                minutesElement.textContent = minutes.toString().padStart(2, '0');
                secondsElement.textContent = seconds.toString().padStart(2, '0');
            }
            
            // Update immediately
            updateCountdown();
            
            // Update every second
            setInterval(updateCountdown, 1000);
        }
        
        // Splash screen handler
        function initSplashScreen() {
            const splashScreen = document.getElementById('splash-screen');
            if (!splashScreen) return;
            
            let contentStarted = false;
            
            const startContent = () => {
                if (contentStarted) return;
                contentStarted = true;
                
                console.log('üé¨ Kapak ekranƒ± tƒ±klandƒ±, i√ßerik ba≈ülatƒ±lƒ±yor...');
                
                // Hide splash screen
                splashScreen.classList.add('hidden');
                
                // Remove splash screen from DOM after animation
                setTimeout(() => {
                    if (splashScreen.parentNode) {
                        splashScreen.parentNode.removeChild(splashScreen);
                    }
                }, 500);
                
                // Start main content
                hideCutTables();
                setTimeout(showTablesRandomly, 100); // Small delay to ensure layout is ready
                setTimeout(showBrideGroom, 2000); // Show bride and groom after 2 seconds
                
                // Start music from beginning with user interaction
                // Ensure audio player is ready first
                if (!audioPlayer) {
                    audioPlayer = document.getElementById('music-player');
                }
                
                // If audio player exists, start music directly
                if (audioPlayer) {
                    console.log('üéµ M√ºzik ba≈ülatƒ±lƒ±yor (kullanƒ±cƒ± etkile≈üimi ile)...');
                    
                    // Reset to beginning FIRST
                    audioPlayer.currentTime = 0;
                    
                    // Unmute and set volume
                    audioPlayer.muted = false;
                    audioPlayer.volume = 1.0;
                    
                    // Small delay to ensure currentTime is set
                    setTimeout(() => {
                        try {
                            // Play the audio
                            const playPromise = audioPlayer.play();
                            if (playPromise !== undefined) {
                                playPromise.then(() => {
                                    musicUnmuted = true;
                                    console.log('‚úÖ M√ºzik √ßalƒ±yor (ses a√ßƒ±k)');
                                }).catch((e) => {
                                    console.error('‚ùå M√ºzik oynatƒ±lamadƒ±:', e);
                                    musicUnmuted = false;
                                    
                                    // Retry after a short delay
                                    setTimeout(() => {
                                        try {
                                            audioPlayer.currentTime = 0;
                                            audioPlayer.muted = false;
                                            audioPlayer.volume = 1.0;
                                            audioPlayer.play().then(() => {
                                                musicUnmuted = true;
                                                console.log('‚úÖ M√ºzik tekrar denendi ve √ßalƒ±yor');
                                            }).catch((retryError) => {
                                                console.error('‚ùå M√ºzik tekrar denemesi ba≈üarƒ±sƒ±z:', retryError);
                                            });
                                        } catch (retryError) {
                                            console.error('‚ùå M√ºzik tekrar denemesi hatasƒ±:', retryError);
                                        }
                                    }, 200);
                                });
                            }
                        } catch (e) {
                            console.error('‚ùå M√ºzik ba≈ülatma hatasƒ±:', e);
                        }
                    }, 50);
                } else if (window.unmuteAndPlay) {
                    // Fallback to global function
                    console.log('‚ö†Ô∏è Audio player bulunamadƒ±, global fonksiyon kullanƒ±lƒ±yor');
                    musicUnmuted = false; // Reset to allow unmute
                    window.unmuteAndPlay();
                } else {
                    console.error('‚ùå M√ºzik ba≈ülatƒ±lamadƒ±: Audio player ve unmuteAndPlay fonksiyonu bulunamadƒ±');
                }
            };
            
            // Add click/touch listeners
            splashScreen.addEventListener('click', startContent, { once: true });
            splashScreen.addEventListener('touchstart', startContent, { once: true });
            
            console.log('‚úÖ Kapak ekranƒ± hazƒ±r');
        }
        
        // Run on load
        window.addEventListener('load', () => {
            // Force set background color to override any cached styles
            // Use backgroundColor only, not background (to avoid overriding background-image)
            document.body.style.backgroundColor = '#fffaee';
            
            // Initialize splash screen first
            initSplashScreen();
        });
        
        // Also try on page reload/refresh
        if (document.readyState === 'complete') {
            initSplashScreen();
        } else {
            document.addEventListener('DOMContentLoaded', () => {
                initSplashScreen();
            });
        }
        
        // RSVP Modal functionality
        function initRSVP() {
            const rsvpButton = document.getElementById('rsvp-button');
            const rsvpModal = document.getElementById('rsvp-modal');
            const rsvpClose = document.getElementById('rsvp-close');
            const rsvpForm = document.getElementById('rsvp-form');
            const attendanceRadios = document.querySelectorAll('input[name="attendance"]');
            const guestCountInput = document.getElementById('rsvp-guest-count');
            const rsvpSuccess = document.getElementById('rsvp-success');
            
            if (!rsvpButton || !rsvpModal || !rsvpClose || !rsvpForm) {
                console.log('‚ö†Ô∏è RSVP elementleri bulunamadƒ±');
                return;
            }
            
            // Open modal
            rsvpButton.addEventListener('click', () => {
                rsvpModal.classList.add('active');
                document.body.style.overflow = 'hidden';
            });
            
            // Close modal
            rsvpClose.addEventListener('click', () => {
                rsvpModal.classList.remove('active');
                document.body.style.overflow = '';
            });
            
            // Close modal when clicking outside
            rsvpModal.addEventListener('click', (e) => {
                if (e.target === rsvpModal) {
                    rsvpModal.classList.remove('active');
                    document.body.style.overflow = '';
                }
            });
            
            // Handle radio button selection styling
            attendanceRadios.forEach(radio => {
                radio.addEventListener('change', () => {
                    // Remove selected class from all options
                    document.querySelectorAll('.attendance-option').forEach(option => {
                        option.classList.remove('selected');
                    });
                    // Add selected class to checked option's parent
                    if (radio.checked) {
                        radio.closest('.attendance-option').classList.add('selected');
                    }
                });
            });
            
            // Handle form submission
            rsvpForm.addEventListener('submit', (e) => {
                e.preventDefault();
                
                const selectedAttendance = document.querySelector('input[name="attendance"]:checked');
                
                const formData = {
                    firstname: document.getElementById('rsvp-firstname').value,
                    lastname: document.getElementById('rsvp-lastname').value,
                    attendance: selectedAttendance ? selectedAttendance.value : '',
                    guestCount: parseInt(guestCountInput.value) || 1
                };
                
                console.log('RSVP Form Data:', formData);
                
                // Here you would typically send data to a server
                // For now, we'll just show success message
                
                // Hide form and show success message
                rsvpForm.style.display = 'none';
                if (rsvpSuccess) {
                    const successMessage = document.getElementById('rsvp-success-message');
                    if (successMessage) {
                        // Set message based on attendance
                        if (selectedAttendance && selectedAttendance.value === 'yes') {
                            successMessage.textContent = 'Sizleri aramƒ±zda g√∂rmekten mutluluk duyacaƒüƒ±z.';
                        } else {
                            successMessage.textContent = 'Yine de sizleri d√º≈ü√ºnd√ºƒü√ºm√ºz√º bilmenizi isteriz.';
                        }
                    }
                    rsvpSuccess.style.display = 'block';
                }
                
                // Close modal after 5.5 seconds (give time to read the message)
                setTimeout(() => {
                    rsvpModal.classList.remove('active');
                    document.body.style.overflow = '';
                    
                    // Reset form after closing
                    setTimeout(() => {
                        rsvpForm.reset();
                        rsvpForm.style.display = 'flex';
                        if (rsvpSuccess) rsvpSuccess.style.display = 'none';
                        if (guestCountInput) guestCountInput.value = '1';
                        // Remove selected class from attendance options
                        document.querySelectorAll('.attendance-option').forEach(option => {
                            option.classList.remove('selected');
                        });
                    }, 300);
                }, 5500);
            });
        }
        
        // Initialize RSVP when page loads
        window.addEventListener('load', () => {
            initRSVP();
        });
        
        if (document.readyState === 'complete') {
            initRSVP();
        } else {
            document.addEventListener('DOMContentLoaded', () => {
                initRSVP();
            });
        }
        
        // Run on resize
        window.addEventListener('resize', () => {
            const isMobile = window.innerWidth <= 480;
            // Reset positioning flag on resize if switching to/from mobile
            if (!isMobile) {
                tablesPositioned = false;
                // Reset visibility for desktop/tablet
                document.querySelectorAll('.table-item').forEach(table => {
                    table.style.visibility = '';
                    table.style.pointerEvents = '';
                });
            }
            
            // Reset all tables to invisible first
            document.querySelectorAll('.table-item').forEach(table => {
                table.style.opacity = '0';
            });
            hideCutTables();
            setTimeout(showTablesRandomly, 100);
            
            // Update frame image if frame is already shown (cache-busting on resize)
            if (document.body.classList.contains('show-frame')) {
                const timestamp = new Date().getTime();
                // Check both width and orientation for better mobile detection
                const isMobile = window.innerWidth <= 480 || (window.innerWidth <= 768 && window.matchMedia('(orientation: portrait)').matches);
                
                if (isMobile) {
                    document.body.style.backgroundImage = `url('frame-portrait.png?v=${timestamp}')`;
                    document.body.style.backgroundSize = 'contain';
                    document.body.style.backgroundPosition = '50% 60%';
                    document.body.style.backgroundRepeat = 'no-repeat';
                    document.body.style.padding = '0';
                    document.body.style.margin = '0';
                    document.body.style.height = '100vh';
                    document.body.style.minHeight = '100vh';
                    document.body.style.display = 'flex';
                    document.body.style.alignItems = 'center';
                    document.body.style.justifyContent = 'center';
                } else {
                    document.body.style.backgroundImage = `url('frame-landscape.png?v=${timestamp}')`;
                    if (window.innerWidth >= 769) {
                        document.body.style.backgroundSize = '70% auto';
                    } else {
                        document.body.style.backgroundSize = 'contain';
                    }
                }
            }
        });
    </script>
</body>
</html>
