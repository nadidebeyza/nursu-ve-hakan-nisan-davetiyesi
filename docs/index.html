<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NiÅŸan Davetiyesi</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Monsieur+La+Doulaise&display=swap" rel="stylesheet">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=DM+Serif+Text:ital@0;1&display=swap" rel="stylesheet">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Rozha+One&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
    <!-- YouTube IFrame API -->
    <script src="https://www.youtube.com/iframe_api"></script>
</head>
<body>
    <!-- Hidden YouTube Music Player -->
    <div id="youtube-music"></div>
    
    <!-- Invisible overlay to capture first user interaction for autoplay -->
    <div id="music-activator-overlay" style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: 9999; background: transparent; cursor: pointer;"></div>
    
    <div class="tables-container">
        <div class="table-item">
            <img src="guest-table.png" alt="Misafir MasasÄ±" class="guest-table-image">
        </div>
        <div class="table-item">
            <img src="guest-table.png" alt="Misafir MasasÄ±" class="guest-table-image">
        </div>
        <div class="table-item">
            <img src="guest-table.png" alt="Misafir MasasÄ±" class="guest-table-image">
        </div>
        <div class="table-item">
            <img src="guest-table.png" alt="Misafir MasasÄ±" class="guest-table-image">
        </div>
        <div class="table-item">
            <img src="guest-table.png" alt="Misafir MasasÄ±" class="guest-table-image">
        </div>
        <div class="table-item">
            <img src="guest-table.png" alt="Misafir MasasÄ±" class="guest-table-image">
        </div>
        <div class="table-item">
            <img src="guest-table.png" alt="Misafir MasasÄ±" class="guest-table-image">
        </div>
        <div class="table-item">
            <img src="guest-table.png" alt="Misafir MasasÄ±" class="guest-table-image">
        </div>
        <div class="table-item">
            <img src="guest-table.png" alt="Misafir MasasÄ±" class="guest-table-image">
        </div>
        <div class="table-item">
            <img src="guest-table.png" alt="Misafir MasasÄ±" class="guest-table-image">
        </div>
        <div class="table-item">
            <img src="guest-table.png" alt="Misafir MasasÄ±" class="guest-table-image">
        </div>
        <div class="table-item">
            <img src="guest-table.png" alt="Misafir MasasÄ±" class="guest-table-image">
        </div>
        <div class="table-item">
            <img src="guest-table.png" alt="Misafir MasasÄ±" class="guest-table-image">
        </div>
        <div class="table-item">
            <img src="guest-table.png" alt="Misafir MasasÄ±" class="guest-table-image">
        </div>
        <div class="table-item">
            <img src="guest-table.png" alt="Misafir MasasÄ±" class="guest-table-image">
        </div>
        <div class="table-item">
            <img src="guest-table.png" alt="Misafir MasasÄ±" class="guest-table-image">
        </div>
        <div class="table-item">
            <img src="guest-table.png" alt="Misafir MasasÄ±" class="guest-table-image">
        </div>
        <div class="table-item">
            <img src="guest-table.png" alt="Misafir MasasÄ±" class="guest-table-image">
        </div>
        <div class="table-item">
            <img src="guest-table.png" alt="Misafir MasasÄ±" class="guest-table-image">
        </div>
        <div class="table-item">
            <img src="guest-table.png" alt="Misafir MasasÄ±" class="guest-table-image">
        </div>
        <div class="table-item">
            <img src="guest-table.png" alt="Misafir MasasÄ±" class="guest-table-image">
        </div>
        <div class="table-item">
            <img src="guest-table.png" alt="Misafir MasasÄ±" class="guest-table-image">
        </div>
        <div class="table-item">
            <img src="guest-table.png" alt="Misafir MasasÄ±" class="guest-table-image">
        </div>
        <div class="table-item">
            <img src="guest-table.png" alt="Misafir MasasÄ±" class="guest-table-image">
        </div>
        <div class="table-item">
            <img src="guest-table.png" alt="Misafir MasasÄ±" class="guest-table-image">
        </div>
        <div class="table-item">
            <img src="guest-table.png" alt="Misafir MasasÄ±" class="guest-table-image">
        </div>
        <div class="table-item">
            <img src="guest-table.png" alt="Misafir MasasÄ±" class="guest-table-image">
        </div>
        <div class="table-item">
            <img src="guest-table.png" alt="Misafir MasasÄ±" class="guest-table-image">
        </div>
        <div class="table-item">
            <img src="guest-table.png" alt="Misafir MasasÄ±" class="guest-table-image">
        </div>
        <div class="table-item">
            <img src="guest-table.png" alt="Misafir MasasÄ±" class="guest-table-image">
        </div>
        <div class="table-item">
            <img src="guest-table.png" alt="Misafir MasasÄ±" class="guest-table-image">
        </div>
        <div class="table-item">
            <img src="guest-table.png" alt="Misafir MasasÄ±" class="guest-table-image">
        </div>
        <div class="table-item">
            <img src="guest-table.png" alt="Misafir MasasÄ±" class="guest-table-image">
        </div>
        <div class="table-item">
            <img src="guest-table.png" alt="Misafir MasasÄ±" class="guest-table-image">
        </div>
        <div class="table-item">
            <img src="guest-table.png" alt="Misafir MasasÄ±" class="guest-table-image">
        </div>
        <div class="table-item">
            <img src="guest-table.png" alt="Misafir MasasÄ±" class="guest-table-image">
        </div>
        <div class="table-item">
            <img src="guest-table.png" alt="Misafir MasasÄ±" class="guest-table-image">
        </div>
        <div class="table-item">
            <img src="guest-table.png" alt="Misafir MasasÄ±" class="guest-table-image">
        </div>
        <div class="table-item">
            <img src="guest-table.png" alt="Misafir MasasÄ±" class="guest-table-image">
        </div>
        <div class="table-item">
            <img src="guest-table.png" alt="Misafir MasasÄ±" class="guest-table-image">
        </div>
        <div class="table-item">
            <img src="guest-table.png" alt="Misafir MasasÄ±" class="guest-table-image">
        </div>
        <div class="table-item">
            <img src="guest-table.png" alt="Misafir MasasÄ±" class="guest-table-image">
        </div>
        <div class="table-item">
            <img src="guest-table.png" alt="Misafir MasasÄ±" class="guest-table-image">
        </div>
        <div class="table-item">
            <img src="guest-table.png" alt="Misafir MasasÄ±" class="guest-table-image">
        </div>
        <div class="table-item">
            <img src="guest-table.png" alt="Misafir MasasÄ±" class="guest-table-image">
        </div>
        <div class="table-item">
            <img src="guest-table.png" alt="Misafir MasasÄ±" class="guest-table-image">
        </div>
        <div class="table-item">
            <img src="guest-table.png" alt="Misafir MasasÄ±" class="guest-table-image">
        </div>
        <div class="table-item">
            <img src="guest-table.png" alt="Misafir MasasÄ±" class="guest-table-image">
        </div>
        <div class="table-item">
            <img src="guest-table.png" alt="Misafir MasasÄ±" class="guest-table-image">
        </div>
    </div>
    <div class="logo-container">
        <img src="logo.png" alt="Logo" class="logo-image">
    </div>
    <div class="names-container">
        <h1 class="couple-names">Nursu & Hakan</h1>
        <p class="event-date">15 ÅžUBAT 2026</p>
        <p class="invitation-message">NiÅŸan tÃ¶renimizde sizleri de aramÄ±zda gÃ¶rmekten mutluluk duyarÄ±z.</p>
        <div class="family-names-container">
            <p class="family-name-left">Ã–rsel Ailesi</p>
            <p class="family-name-right">AytaÃ§ Ailesi</p>
        </div>
        <p class="event-location">KONUM: TEKÄ°RDAÄž</p>
    </div>
    <div class="bride-groom-container">
        <img src="bride-and-groom.png" alt="Gelin ve Damat" class="bride-groom-image">
    </div>
    <script>
        // CRITICAL: This must run immediately
        console.log('ðŸš€ðŸš€ðŸš€ SCRIPT TAG Ã‡ALIÅžTI - GitHub Pages Test ðŸš€ðŸš€ðŸš€');
        window.testScriptLoaded = true;
        console.log('Sayfa URL:', window.location.href);
        console.log('Document ready state:', document.readyState);
        console.log('Timestamp:', new Date().toISOString());
        
        // Test if script tag is executed - make it very visible
        if (typeof window !== 'undefined') {
            window.testScriptLoaded = true;
            console.log('âœ… Window object mevcut');
            // Make it visible in page title too
            if (document.title) {
                document.title = 'âœ… Script Ã‡alÄ±ÅŸtÄ± - ' + document.title;
            }
        }
        
        let youtubePlayer;
        let playerReady = false;
        let musicUnmuted = false; // Global flag to track if music is unmuted
        let listenersAdded = false; // Track if listeners are already added
        
        // Auto-simulate user interaction (click/touch) - Independent function
        function simulateUserInteraction() {
            console.log('ðŸŽ¯ Otomatik kullanÄ±cÄ± etkileÅŸimi simÃ¼le ediliyor...');
            
            // Create and dispatch click event
            const clickEvent = new MouseEvent('click', {
                view: window,
                bubbles: true,
                cancelable: true,
                buttons: 1
            });
            
            // Create and dispatch touch event
            const touchEvent = new TouchEvent('touchstart', {
                view: window,
                bubbles: true,
                cancelable: true,
                touches: [new Touch({
                    identifier: Date.now(),
                    target: document.body,
                    clientX: window.innerWidth / 2,
                    clientY: window.innerHeight / 2,
                    radiusX: 2.5,
                    radiusY: 2.5,
                    rotationAngle: 10,
                    force: 0.5
                })]
            });
            
            // Try multiple methods
            try {
                // Method 1: Dispatch on body
                document.body.dispatchEvent(clickEvent);
                console.log('âœ… Click event dispatched on body');
            } catch (e) {
                console.log('Click event dispatch hatasÄ±:', e);
            }
            
            try {
                // Method 2: Dispatch on document
                document.dispatchEvent(clickEvent);
                console.log('âœ… Click event dispatched on document');
            } catch (e) {
                console.log('Document click dispatch hatasÄ±:', e);
            }
            
            try {
                // Method 3: Dispatch on window
                window.dispatchEvent(clickEvent);
                console.log('âœ… Click event dispatched on window');
            } catch (e) {
                console.log('Window click dispatch hatasÄ±:', e);
            }
            
            try {
                // Method 4: Touch event
                document.body.dispatchEvent(touchEvent);
                console.log('âœ… Touch event dispatched on body');
            } catch (e) {
                console.log('Touch event dispatch hatasÄ±:', e);
            }
            
            try {
                // Method 5: Direct function call (if exists)
                if (window.unmuteAndPlay) {
                    window.unmuteAndPlay();
                    console.log('âœ… unmuteAndPlay direkt Ã§aÄŸrÄ±ldÄ±');
                }
            } catch (e) {
                console.log('unmuteAndPlay Ã§aÄŸrÄ± hatasÄ±:', e);
            }
            
            // Also try creating a fake user gesture
            try {
                // Create a temporary button and click it programmatically
                const tempButton = document.createElement('button');
                tempButton.style.position = 'fixed';
                tempButton.style.top = '0';
                tempButton.style.left = '0';
                tempButton.style.width = '1px';
                tempButton.style.height = '1px';
                tempButton.style.opacity = '0';
                tempButton.style.pointerEvents = 'none';
                document.body.appendChild(tempButton);
                
                tempButton.click();
                console.log('âœ… Fake button clicked');
                
                setTimeout(() => {
                    document.body.removeChild(tempButton);
                }, 100);
            } catch (e) {
                console.log('Fake button click hatasÄ±:', e);
            }
        }
        
        // Check if YT is available
        function checkYouTubeAPI() {
            console.log('YouTube API kontrol ediliyor...');
            if (typeof YT !== 'undefined' && YT.Player) {
                console.log('YouTube API bulundu!');
                initYouTubePlayer();
                return true;
            } else {
                console.log('YouTube API henÃ¼z yÃ¼klenmedi, bekleniyor...');
                return false;
            }
        }
        
        // Initialize YouTube Player
        function initYouTubePlayer() {
            if (playerReady) {
                console.log('Player zaten hazÄ±r, tekrar baÅŸlatÄ±lmÄ±yor');
                return;
            }
            
            console.log('Player baÅŸlatÄ±lÄ±yor...');
            try {
                youtubePlayer = new YT.Player('youtube-music', {
                    height: '1',
                    width: '1',
                    videoId: 'GxldQ9eX2wo',
                    playerVars: {
                        'autoplay': 1,
                        'loop': 1,
                        'playlist': 'GxldQ9eX2wo',
                        'controls': 0,
                        'showinfo': 0,
                        'modestbranding': 1,
                        'mute': 1,
                        'enablejsapi': 1,
                        'origin': window.location.origin || '*'
                    },
                    events: {
                        'onReady': onPlayerReady,
                        'onStateChange': onPlayerStateChange,
                        'onError': onPlayerError
                    }
                });
                console.log('Player oluÅŸturuldu');
            } catch (e) {
                console.error('Player oluÅŸturulurken hata:', e);
            }
        }
        
        // YouTube IFrame API callback (backup)
        window.onYouTubeIframeAPIReady = function() {
            console.log('âœ… onYouTubeIframeAPIReady Ã§aÄŸrÄ±ldÄ±');
            if (!playerReady) {
                initYouTubePlayer();
            }
        };
        
        // Multiple initialization strategies for GitHub Pages
        function initializeYouTubePlayer() {
            // Strategy 1: Check if API is already loaded
            if (checkYouTubeAPI()) {
                return;
            }
            
            // Strategy 2: Wait for API to load
            let attempts = 0;
            const maxAttempts = 50; // 5 seconds max
            const checkInterval = setInterval(() => {
                attempts++;
                if (checkYouTubeAPI()) {
                    clearInterval(checkInterval);
                } else if (attempts >= maxAttempts) {
                    clearInterval(checkInterval);
                    console.error('âŒ YouTube API yÃ¼klenemedi (max attempts reached)');
                }
            }, 100);
        }
        
        // Start checking for API when page loads
        window.addEventListener('load', () => {
            console.log('ðŸ“„ Sayfa yÃ¼klendi (load event), API kontrolÃ¼ baÅŸlatÄ±lÄ±yor');
            initializeYouTubePlayer();
        });
        
        // Also check immediately
        console.log('ðŸ” Ä°lk API kontrolÃ¼ yapÄ±lÄ±yor...');
        if (document.readyState === 'loading') {
            console.log('Document loading, DOMContentLoaded bekleniyor...');
            document.addEventListener('DOMContentLoaded', () => {
                console.log('ðŸ“„ DOMContentLoaded event tetiklendi');
                initializeYouTubePlayer();
            });
        } else {
            console.log('Document zaten hazÄ±r, hemen kontrol ediliyor');
            initializeYouTubePlayer();
        }
        
        // Extra safety check after a delay
        setTimeout(() => {
            console.log('â° 2 saniye sonra kontrol...');
            if (!playerReady) {
                console.log('Player henÃ¼z hazÄ±r deÄŸil, tekrar kontrol ediliyor...');
                initializeYouTubePlayer();
            }
        }, 2000);
        
        function onPlayerReady(event) {
            console.log('âœ… Player hazÄ±r!');
            playerReady = true;
            
            // Set the global youtubePlayer variable to the actual player instance
            youtubePlayer = event.target;
            console.log('youtubePlayer set edildi:', youtubePlayer);
            
            // Start muted for autoplay compatibility
            try {
                youtubePlayer.mute();
                console.log('Sessiz mod aktif');
            } catch (e) {
                console.log('Sessiz mod ayarlanamadÄ±:', e);
            }
            
            // Try to play the video
            try {
                youtubePlayer.playVideo();
                console.log('â–¶ï¸ Video oynatÄ±lmaya baÅŸlandÄ± (sessiz)');
            } catch (e) {
                console.error('Video oynatÄ±lamadÄ±:', e);
            }
            
            // Global function to unmute and play
            window.unmuteAndPlay = function() {
                console.log('ðŸ–±ï¸ unmuteAndPlay Ã§aÄŸrÄ±ldÄ±');
                
                // Check if already unmuted by checking volume (more reliable)
                // Always check, don't trust the flag
                let shouldSkip = false;
                try {
                    if (youtubePlayer && typeof youtubePlayer.isMuted === 'function') {
                        const isMuted = youtubePlayer.isMuted();
                        const volume = youtubePlayer.getVolume ? youtubePlayer.getVolume() : null;
                        console.log('Ses kontrolÃ¼ - isMuted:', isMuted, 'Volume:', volume);
                        
                        if (!isMuted && volume !== null && volume > 0) {
                            console.log('âœ… MÃ¼zik zaten aÃ§Ä±k (isMuted=false, volume>0), tekrar aÃ§Ä±lmaya gerek yok');
                            musicUnmuted = true;
                            shouldSkip = true;
                        } else {
                            console.log('âš ï¸ MÃ¼zik hala sessiz veya volume=0, tekrar aÃ§Ä±lmaya Ã§alÄ±ÅŸÄ±lÄ±yor...');
                            musicUnmuted = false; // Reset flag if still muted
                        }
                    }
                } catch (e) {
                    console.log('isMuted/volume kontrol edilemedi:', e);
                    // If we can't check, don't skip - try to unmute anyway
                    musicUnmuted = false;
                }
                
                if (shouldSkip && musicUnmuted) {
                    return;
                }
                
                console.log('Ses aÃ§Ä±lmaya Ã§alÄ±ÅŸÄ±lÄ±yor...');
                
                // Try multiple ways to find the iframe
                let iframe = null;
                
                // Method 1: Direct ID
                const container = document.getElementById('youtube-music');
                if (container) {
                    // Method 2: Find iframe inside container
                    iframe = container.querySelector('iframe');
                    if (!iframe) {
                        // Method 3: Find by tag name
                        const iframes = container.getElementsByTagName('iframe');
                        if (iframes.length > 0) {
                            iframe = iframes[0];
                        }
                    }
                }
                
                // Method 4: Find all iframes and check if any is YouTube
                if (!iframe) {
                    const allIframes = document.querySelectorAll('iframe');
                    for (let i = 0; i < allIframes.length; i++) {
                        if (allIframes[i].src && allIframes[i].src.includes('youtube.com')) {
                            iframe = allIframes[i];
                            break;
                        }
                    }
                }
                
                console.log('iframe bulundu mu?', !!iframe);
                if (iframe) {
                    console.log('iframe src:', iframe.src);
                    console.log('iframe contentWindow var mÄ±?', !!iframe.contentWindow);
                }
                
                if (iframe && iframe.contentWindow) {
                    try {
                        // Extract origin from iframe src dynamically
                        let origin = 'https://www.youtube.com'; // Default
                        if (iframe.src) {
                            try {
                                const url = new URL(iframe.src);
                                origin = url.origin;
                                console.log('Origin iframe src\'den Ã§Ä±karÄ±ldÄ±:', origin);
                            } catch (e) {
                                console.log('Origin Ã§Ä±karÄ±lamadÄ±, varsayÄ±lan kullanÄ±lÄ±yor:', origin);
                            }
                        }
                        
                        console.log('postMessage gÃ¶nderiliyor, origin:', origin);
                        
                        // Function to send command
                        const sendCommand = (cmd, targetOrigin) => {
                            try {
                                iframe.contentWindow.postMessage(JSON.stringify(cmd), targetOrigin);
                                console.log(`âœ… postMessage gÃ¶nderildi (${targetOrigin}):`, cmd.func);
                                return true;
                            } catch (e) {
                                console.warn(`âš ï¸ postMessage hatasÄ± (${targetOrigin}):`, e);
                                return false;
                            }
                        };
                        
                        // Send commands with proper format - try multiple origins
                        const commands = [
                            {event: 'command', func: 'unMute', args: ''},
                            {event: 'command', func: 'playVideo', args: ''},
                            {event: 'command', func: 'setVolume', args: [100]}
                        ];
                        
                        // Try with extracted origin first
                        commands.forEach((cmd, index) => {
                            setTimeout(() => {
                                sendCommand(cmd, origin);
                            }, index * 50);
                        });
                        
                        // Also try with wildcard origin as fallback
                        setTimeout(() => {
                            commands.forEach((cmd, index) => {
                                setTimeout(() => {
                                    sendCommand(cmd, '*');
                                }, index * 50);
                            });
                        }, 200);
                        
                        // Try with explicit YouTube origins
                        setTimeout(() => {
                            commands.forEach((cmd, index) => {
                                setTimeout(() => {
                                    sendCommand(cmd, 'https://www.youtube.com');
                                    sendCommand(cmd, 'https://youtube.com');
                                }, index * 50);
                            });
                        }, 400);
                        
                        // Don't set musicUnmuted = true immediately
                        // Instead, verify it worked after a delay with multiple checks
                        const verifyUnmute = (checkNumber, delay) => {
                            setTimeout(() => {
                                try {
                                    if (youtubePlayer && typeof youtubePlayer.isMuted === 'function') {
                                        const isMuted = youtubePlayer.isMuted();
                                        const volume = youtubePlayer.getVolume ? youtubePlayer.getVolume() : null;
                                        console.log(`Ses kontrolÃ¼ (${checkNumber}. kontrol, ${delay}ms sonra) - isMuted:`, isMuted, 'Volume:', volume);
                                        
                                        if (!isMuted && volume !== null && volume > 0) {
                                            // Check if video is actually playing
                                            const state = youtubePlayer.getPlayerState ? youtubePlayer.getPlayerState() : null;
                                            console.log(`Ses aÃ§Ä±k, player state: ${state} (PLAYING=1, UNSTARTED=-1)`);
                                            
                                            if (state === YT.PlayerState.PLAYING) {
                                                musicUnmuted = true;
                                                console.log(`âœ… Ses gerÃ§ekten aÃ§Ä±ldÄ± ve video Ã§alÄ±yor! (${checkNumber}. kontrol - isMuted=false, volume=${volume}, state=PLAYING)`);
                                            } else {
                                                // Video not playing, try to start it
                                                console.log(`âš ï¸ Ses aÃ§Ä±k ama video Ã§almÄ±yor (state=${state}), video baÅŸlatÄ±lÄ±yor...`);
                                                try {
                                                    youtubePlayer.playVideo();
                                                    console.log('â–¶ï¸ playVideo() Ã§aÄŸrÄ±ldÄ±');
                                                } catch (e) {
                                                    console.log('playVideo() hatasÄ±:', e);
                                                }
                                                musicUnmuted = false; // Keep flag false until video is playing
                                            }
                                        } else {
                                            console.log(`âš ï¸ Ses hala kapalÄ± (${checkNumber}. kontrol), tekrar denenecek...`);
                                            musicUnmuted = false; // Keep trying
                                            
                                            // If still muted after multiple checks, try again
                                            if (checkNumber >= 3) {
                                                console.log('ðŸ”„ 3. kontrol sonrasÄ± hala sessiz, tekrar unmute deneniyor...');
                                                setTimeout(() => {
                                                    if (window.unmuteAndPlay) {
                                                        musicUnmuted = false;
                                                        window.unmuteAndPlay();
                                                    }
                                                }, 500);
                                            }
                                        }
                                    } else {
                                        // Fallback: don't set flag if we can't verify
                                        console.log(`âš ï¸ Ses kontrolÃ¼ yapÄ±lamadÄ± (${checkNumber}. kontrol), flag set edilmedi`);
                                        musicUnmuted = false; // Don't trust if we can't verify
                                    }
                                } catch (e) {
                                    console.log(`Ses kontrolÃ¼ hatasÄ± (${checkNumber}. kontrol):`, e);
                                    musicUnmuted = false; // Don't trust on error
                                }
                            }, delay);
                        };
                        
                        // Multiple verification checks
                        verifyUnmute(1, 1000);  // 1 second
                        verifyUnmute(2, 2000);  // 2 seconds
                        verifyUnmute(3, 3000);  // 3 seconds
                        
                        console.log('ðŸ”Š Ses aÃ§ma komutlarÄ± gÃ¶nderildi, kontrol ediliyor...');
                    } catch (e) {
                        console.error('postMessage hatasÄ±:', e);
                    }
                } else {
                    console.error('âŒ iframe bulunamadÄ± veya contentWindow yok');
                    console.log('TÃ¼m iframe\'ler:', document.querySelectorAll('iframe'));
                }
            };
            
            // Add event listeners only once, but wait a bit for GitHub Pages
            if (!listenersAdded) {
                const addUnmuteListeners = () => {
                    // Remove old listeners first to avoid duplicates
                    try {
                        document.body.removeEventListener('click', window.unmuteAndPlay, true);
                        document.body.removeEventListener('touchstart', window.unmuteAndPlay, true);
                    } catch (e) {
                        // Ignore if listeners don't exist
                    }
                    
                    // Add new listeners
                    document.body.addEventListener('click', window.unmuteAndPlay, true);
                    document.body.addEventListener('touchstart', window.unmuteAndPlay, true);
                    document.addEventListener('click', window.unmuteAndPlay, true);
                    document.addEventListener('touchstart', window.unmuteAndPlay, true);
                    document.addEventListener('keydown', window.unmuteAndPlay, true);
                    window.addEventListener('click', window.unmuteAndPlay, true);
                    console.log('âœ… Event listener\'lar eklendi');
                };
                
                // Add listeners with delays for GitHub Pages compatibility
                addUnmuteListeners();
                setTimeout(addUnmuteListeners, 500);
                setTimeout(addUnmuteListeners, 1000); // Extra delay for GitHub Pages
                
                listenersAdded = true;
            }
            
            // Auto-start music after player is ready (simulate user interaction)
            // For GitHub Pages: More aggressive retry with longer delays
            const tryAutoUnmute = (attempt, delay) => {
                setTimeout(() => {
                    console.log(`ðŸŽµ Otomatik mÃ¼zik baÅŸlatma denemesi (${attempt}. deneme, ${delay}ms sonra)...`);
                    
                    // Check if player is actually playing
                    if (youtubePlayer && typeof youtubePlayer.getPlayerState === 'function') {
                        try {
                            const state = youtubePlayer.getPlayerState();
                            console.log('Player state:', state, '(PLAYING=1, PAUSED=2)');
                            
                            // Try to start video if not playing
                            if (state === YT.PlayerState.UNSTARTED || state === YT.PlayerState.ENDED) {
                                console.log('Player UNSTARTED veya ENDED, video baÅŸlatÄ±lÄ±yor...');
                                try {
                                    youtubePlayer.playVideo();
                                    console.log('â–¶ï¸ playVideo() Ã§aÄŸrÄ±ldÄ± (UNSTARTED/ENDED durumunda)');
                                } catch (e) {
                                    console.log('playVideo() hatasÄ±:', e);
                                }
                            }
                            
                            // Only try to unmute if player is playing or ready
                            if (state === YT.PlayerState.PLAYING || state === YT.PlayerState.BUFFERING || state === YT.PlayerState.CUED) {
                                if (window.unmuteAndPlay && !musicUnmuted) {
                                    window.unmuteAndPlay();
                                }
                            } else {
                                console.log(`Player henÃ¼z Ã§almÄ±yor (state=${state}), tekrar denenecek...`);
                            }
                        } catch (e) {
                            console.log('Player state kontrol edilemedi:', e);
                            // Fallback: try anyway
                            if (window.unmuteAndPlay && !musicUnmuted) {
                                window.unmuteAndPlay();
                            }
                        }
                    } else {
                        // Fallback if getPlayerState not available
                        if (window.unmuteAndPlay && !musicUnmuted) {
                            window.unmuteAndPlay();
                        }
                    }
                }, delay);
            };
            
            // Multiple attempts with increasing delays for GitHub Pages
            tryAutoUnmute(1, 2000);  // 2 seconds
            tryAutoUnmute(2, 4000);  // 4 seconds
            tryAutoUnmute(3, 6000);  // 6 seconds
            tryAutoUnmute(4, 8000);  // 8 seconds (GitHub Pages iÃ§in ekstra)
            tryAutoUnmute(5, 10000); // 10 seconds (GitHub Pages iÃ§in ekstra)
        }
        
        function onPlayerStateChange(event) {
            console.log('Player durumu deÄŸiÅŸti:', event.data);
            // YT.PlayerState.PLAYING = 1, PAUSED = 2, ENDED = 0
            if (event.data === YT.PlayerState.PLAYING) {
                console.log('â–¶ï¸ MÃ¼zik Ã§alÄ±yor');
                
                // Auto-unmute when video starts playing (GitHub Pages fix)
                // Check if actually muted before trying
                setTimeout(() => {
                    try {
                        if (youtubePlayer && typeof youtubePlayer.isMuted === 'function') {
                            const isMuted = youtubePlayer.isMuted();
                            console.log('Player isMuted kontrolÃ¼:', isMuted);
                            
                            if (isMuted && window.unmuteAndPlay) {
                                console.log('ðŸŽµ Video Ã§alÄ±yor ama sessiz, otomatik ses aÃ§Ä±lÄ±yor...');
                                musicUnmuted = false; // Reset flag to allow retry
                                window.unmuteAndPlay();
                            } else if (!isMuted) {
                                musicUnmuted = true;
                                console.log('âœ… Ses zaten aÃ§Ä±k!');
                            }
                        } else {
                            // Fallback: try unmute anyway
                            if (!musicUnmuted && window.unmuteAndPlay) {
                                console.log('ðŸŽµ Video Ã§alÄ±yor, otomatik ses aÃ§Ä±lÄ±yor (fallback)...');
                                window.unmuteAndPlay();
                            }
                        }
                    } catch (e) {
                        console.log('isMuted kontrolÃ¼ yapÄ±lamadÄ±:', e);
                        // Fallback: try unmute anyway
                        if (!musicUnmuted && window.unmuteAndPlay) {
                            window.unmuteAndPlay();
                        }
                    }
                }, 1000); // 1 second delay to ensure player is ready
            } else if (event.data === YT.PlayerState.PAUSED) {
                console.log('â¸ï¸ Video duraklatÄ±ldÄ±');
                // If paused, might need user interaction to resume
                console.log('Video duraklatÄ±ldÄ±, kullanÄ±cÄ± etkileÅŸimi bekleniyor...');
            } else if (event.data === YT.PlayerState.ENDED) {
                console.log('â¹ï¸ Video bitti');
            }
        }
        
        function onPlayerError(event) {
            console.error('Player hatasÄ±:', event.data);
        }
        
        function hideCutTables() {
            const container = document.querySelector('.tables-container');
            const tables = document.querySelectorAll('.table-item');
            const containerRect = container.getBoundingClientRect();
            
            tables.forEach(table => {
                const tableRect = table.getBoundingClientRect();
                const isVisible = tableRect.top >= containerRect.top && 
                                 tableRect.bottom <= containerRect.bottom;
                
                if (!isVisible) {
                    table.style.display = 'none';
                } else {
                    table.style.display = 'flex';
                }
            });
        }
        
        function showTablesRandomly() {
            const tables = Array.from(document.querySelectorAll('.table-item'));
            // Filter only visible tables (not cut off)
            const container = document.querySelector('.tables-container');
            const containerRect = container.getBoundingClientRect();
            
            const visibleTables = tables.filter(table => {
                const tableRect = table.getBoundingClientRect();
                return tableRect.top >= containerRect.top && 
                       tableRect.bottom <= containerRect.bottom;
            });
            
            // Shuffle array randomly
            for (let i = visibleTables.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [visibleTables[i], visibleTables[j]] = [visibleTables[j], visibleTables[i]];
            }
            
            // Show tables one by one with delay
            visibleTables.forEach((table, index) => {
                setTimeout(() => {
                    table.style.opacity = '1';
                }, index * 50); // 50ms delay between each table
            });
        }
        
        function showBrideGroom() {
            const brideGroom = document.querySelector('.bride-groom-container');
            if (brideGroom) {
                brideGroom.style.opacity = '1';
                // Start flower rain after bride-groom appears
                setTimeout(startFlowerRain, 500);
            }
        }
        
        let firstFlowerLanded = false;
        
        function startFlowerRain() {
            const flowerContainer = document.createElement('div');
            flowerContainer.className = 'flower-container';
            document.body.appendChild(flowerContainer);
            
            const flowerCount = 150; // Tonlarca Ã§iÃ§ek
            const screenWidth = window.innerWidth;
            
            for (let i = 0; i < flowerCount; i++) {
                setTimeout(() => {
                    createFlower(flowerContainer, screenWidth, i === 0);
                }, i * 20); // Her 20ms'de bir Ã§iÃ§ek oluÅŸtur (daha hÄ±zlÄ±)
            }
            
            // Hide all flowers after they all land on the ground
            // Last flower creation time: (flowerCount - 1) * 20ms
            // Max animation duration: 3s (1.5 + 1.5)
            // Max delay: 0.5s
            // Total: ~6.5 seconds
            const lastFlowerCreationTime = (flowerCount - 1) * 20;
            const maxAnimationTime = 3500; // 3s animation + 0.5s delay (with some buffer)
            const totalTime = lastFlowerCreationTime + maxAnimationTime;
            
            setTimeout(() => {
                const flowers = flowerContainer.querySelectorAll('.falling-flower');
                flowers.forEach(flower => {
                    flower.style.opacity = '0';
                    flower.style.transition = 'opacity 1s ease-out';
                });
                
                // Remove container after fade out
                setTimeout(() => {
                    if (flowerContainer.parentNode) {
                        flowerContainer.parentNode.removeChild(flowerContainer);
                    }
                }, 1000);
            }, totalTime);
        }
        
        function createFlower(container, screenWidth, isFirst) {
            const flower = document.createElement('img');
            flower.src = 'flower.png';
            flower.className = 'falling-flower';
            flower.alt = 'Ã‡iÃ§ek';
            
            // Random horizontal position
            const randomX = Math.random() * screenWidth;
            flower.style.left = randomX + 'px';
            
            // Random size
            const randomSize = 30 + Math.random() * 40; // 30-70px arasÄ±
            flower.style.width = randomSize + 'px';
            flower.style.height = 'auto';
            
            // Random animation duration (daha hÄ±zlÄ±)
            const randomDuration = 1.5 + Math.random() * 1.5; // 1.5-3 saniye arasÄ±
            flower.style.animationDuration = randomDuration + 's';
            
            // Random delay
            const randomDelay = Math.random() * 0.5;
            flower.style.animationDelay = randomDelay + 's';
            
            container.appendChild(flower);
            
            // Hide bride and groom image before frame appears
            if (isFirst && !firstFlowerLanded) {
                firstFlowerLanded = true;
                const totalTime = (randomDuration + randomDelay) * 1000;
                
                // Hide bride and groom image 800ms before frame/text appears
                setTimeout(() => {
                    const brideGroom = document.querySelector('.bride-groom-container');
                    if (brideGroom) {
                        brideGroom.style.opacity = '0';
                    }
                }, totalTime - 800);
                
                setTimeout(() => {
                    showCoupleNames();
                }, totalTime);
            }
        }
        
        function showCoupleNames() {
            const namesContainer = document.querySelector('.names-container');
            const coupleNames = document.querySelector('.couple-names');
            const logoContainer = document.querySelector('.logo-container');
            const message = document.querySelector('.invitation-message');
            
            // Hide all guest table images completely
            const allTables = document.querySelectorAll('.table-item');
            allTables.forEach(table => {
                table.style.opacity = '0';
                table.style.display = 'none';
            });
            
            // Show frame background when tables disappear
            document.body.classList.add('show-frame');
            
            if (namesContainer && coupleNames) {
                // First show couple names
                namesContainer.style.opacity = '1';
                coupleNames.style.opacity = '1';
                
                // Show date together with couple names
                const eventDate = document.querySelector('.event-date');
                if (eventDate) eventDate.style.opacity = '1';
                
                // Then show logo and message after a delay
                setTimeout(() => {
                    if (logoContainer) logoContainer.style.opacity = '1';
                    if (message) message.style.opacity = '1';
                    
                    // Show additional info after message
                    const familyNamesContainer = document.querySelector('.family-names-container');
                    const eventLocation = document.querySelector('.event-location');
                    
                    setTimeout(() => {
                        if (familyNamesContainer) familyNamesContainer.style.opacity = '1';
                        if (eventLocation) eventLocation.style.opacity = '1';
                    }, 300);
                }, 500); // 500ms delay after couple names appear
            }
        }
        
        // Auto-start music function - simulates user interaction
        // Enhanced for GitHub Pages compatibility
        function autoStartMusic() {
            console.log('ðŸŽµ Sayfa yÃ¼klendi, otomatik mÃ¼zik baÅŸlatÄ±lÄ±yor...');
            console.log('Player hazÄ±r mÄ±?', playerReady);
            console.log('unmuteAndPlay fonksiyonu var mÄ±?', typeof window.unmuteAndPlay);
            
            // Wait for player to be ready first
            const tryUnmuteWhenReady = (attempt, delay) => {
                setTimeout(() => {
                    console.log(`ðŸŽµ Otomatik baÅŸlatma denemesi (sayfa yÃ¼klendi, ${delay}ms sonra, deneme ${attempt})...`);
                    console.log('Player ready:', playerReady, 'Music unmuted:', musicUnmuted);
                    
                    // Only try if player is ready
                    if (playerReady && window.unmuteAndPlay && !musicUnmuted) {
                        // Check if iframe exists
                        const container = document.getElementById('youtube-music');
                        const iframe = container ? container.querySelector('iframe') : null;
                        
                        if (iframe) {
                            console.log('âœ… iframe bulundu, unmute deneniyor...');
                            window.unmuteAndPlay();
                        } else {
                            console.log('â³ iframe henÃ¼z yok, bekleniyor...');
                        }
                    } else {
                        console.log('â³ KoÅŸullar henÃ¼z hazÄ±r deÄŸil, bekleniyor...');
                    }
                }, delay);
            };
            
            // Multiple attempts with longer delays for GitHub Pages
            tryUnmuteWhenReady(1, 3000);  // 3 seconds
            tryUnmuteWhenReady(2, 5000);  // 5 seconds
            tryUnmuteWhenReady(3, 7000);  // 7 seconds
            tryUnmuteWhenReady(4, 10000); // 10 seconds
            tryUnmuteWhenReady(5, 15000); // 15 seconds (GitHub Pages iÃ§in ekstra)
        }
        
        // Music activator overlay - captures first user interaction
        function setupMusicActivator() {
            const overlay = document.getElementById('music-activator-overlay');
            if (!overlay) return;
            
            let activated = false;
            
            const activateMusic = (event) => {
                if (activated) return;
                activated = true;
                
                console.log('ðŸŽµ KullanÄ±cÄ± etkileÅŸimi algÄ±landÄ±, mÃ¼zik baÅŸlatÄ±lÄ±yor...');
                
                // Remove overlay
                overlay.style.display = 'none';
                
                // Start music immediately
                if (window.unmuteAndPlay) {
                    musicUnmuted = false; // Reset to allow unmute
                    window.unmuteAndPlay();
                }
                
                // Also try after a short delay
                setTimeout(() => {
                    if (window.unmuteAndPlay && !musicUnmuted) {
                        window.unmuteAndPlay();
                    }
                }, 500);
                
                setTimeout(() => {
                    if (window.unmuteAndPlay && !musicUnmuted) {
                        window.unmuteAndPlay();
                    }
                }, 1000);
            };
            
            // Capture any user interaction
            overlay.addEventListener('click', activateMusic, { once: true });
            overlay.addEventListener('touchstart', activateMusic, { once: true });
            document.addEventListener('click', activateMusic, { once: true });
            document.addEventListener('touchstart', activateMusic, { once: true });
            document.addEventListener('keydown', activateMusic, { once: true });
            document.addEventListener('mousemove', activateMusic, { once: true });
            
            // Auto-remove overlay after 3 seconds (user might have already interacted)
            setTimeout(() => {
                if (!activated && overlay) {
                    overlay.style.display = 'none';
                    console.log('â° Overlay otomatik kaldÄ±rÄ±ldÄ± (3 saniye)');
                }
            }, 3000);
            
            console.log('âœ… MÃ¼zik aktivasyon overlay\'i hazÄ±r');
        }
        
        // Run on load
        window.addEventListener('load', () => {
            hideCutTables();
            setTimeout(showTablesRandomly, 100); // Small delay to ensure layout is ready
            setTimeout(showBrideGroom, 2000); // Show bride and groom after 2 seconds
            setupMusicActivator(); // Setup music activator overlay
            
            // Auto-simulate user interaction after page loads
            setTimeout(() => {
                simulateUserInteraction();
            }, 1000); // 1 second after page load
            
            setTimeout(() => {
                simulateUserInteraction();
            }, 2000); // 2 seconds after page load
            
            setTimeout(() => {
                simulateUserInteraction();
            }, 3000); // 3 seconds after page load
            
            autoStartMusic(); // Auto-start music (fallback)
        });
        
        // Also try on page reload/refresh
        if (document.readyState === 'complete') {
            setupMusicActivator();
            setTimeout(() => {
                simulateUserInteraction();
            }, 500);
            autoStartMusic();
        } else {
            document.addEventListener('DOMContentLoaded', () => {
                setupMusicActivator();
                setTimeout(() => {
                    simulateUserInteraction();
                }, 1000);
            });
        }
        
        // Also try immediately
        setTimeout(() => {
            simulateUserInteraction();
        }, 500);
        
        // Run on resize
        window.addEventListener('resize', () => {
            // Reset all tables to invisible first
            document.querySelectorAll('.table-item').forEach(table => {
                table.style.opacity = '0';
            });
            hideCutTables();
            setTimeout(showTablesRandomly, 100);
        });
    </script>
</body>
</html>
